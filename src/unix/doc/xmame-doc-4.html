<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>XMAME/XMESS DOCUMENTATION: Display Subsystem-Specific Comments and Notes </TITLE>
 <LINK HREF="xmame-doc-5.html" REL=next>
 <LINK HREF="xmame-doc-3.html" REL=previous>
 <LINK HREF="xmame-doc.html#toc4" REL=contents>
</HEAD>
<BODY>
<A HREF="xmame-doc-5.html">Next</A>
<A HREF="xmame-doc-3.html">Previous</A>
<A HREF="xmame-doc.html#toc4">Contents</A>
<HR>
<H2><A NAME="Display subsystem specific comments and notes"></A> <A NAME="s4">4. Display Subsystem-Specific Comments and Notes </A></H2>

<H2><A NAME="ss4.1">4.1 FXmame, a glide driver for xmame</A>
</H2>

<P>The latest version of this driver can be obtained at 
<A HREF="http://glmame.linuxgames.com">http://glmame.linuxgames.com</A>
.
<H3>Requirements</H3>

<P>To run FXmame, you must have:
<P>
<UL>
<LI>A 3Dfx card</LI>
<LI>Glide 2x</LI>
<LI>The xmame distribution</LI>
</UL>
<H3>Compiling and Installing</H3>

<P>FXmame comes in two flavours---xfx and svgafx. The xfx version
is designed to run under X11. It uses an X window for input. The
svgafx version runs from the console, and uses svgalib for input.
Both use the 3Dfx hardware for rendering.
<P>To install FXmame, follow the general instructions for installing
xmame. To specify the glide driver, do the following to the Makefile:
<P>
<UL>
<LI>Select either &quot;xfx&quot; or &quot;svgafx&quot; as your display
method</LI>
<LI>Configure the glide variables to correspond to your glide setup</LI>
</UL>
<P>The FXmame executables are called &quot;xmame.xfx&quot; and &quot;xmame.svgafx&quot;
<H3>Running</H3>

<P>FXmame runs with the same parameters and uses the same keyboard
commands that xmame.x11 does.
<P>A few extra keyboard commands have been added in the glide driver:
<P>
<UL>
<LI>RIGHTCTRL-A -- toggle antialiasing in vector games </LI>
<LI>RIGHTCTRL-B -- toggle bilinear filtering</LI>
</UL>
<P>The glide driver also adds several command-line options:
<P>
<PRE>
    -fxgama &lt;value&gt; 3Dfx gamma correction value
</PRE>
<P>Note that in order to display the game options or the fps display
in vector games, I have to overlay the game bitmap over the vector
display. This is because I circumvent the bitmap entirely in vector
games. Drawing the bitmap is a big cpu hog, so you'll notice that
the game slows down when you turn on the fps display (I know, not
ideal when you want to find out the frame rate...).
<H3>Common Questions (FAQ)</H3>

<P>Q: When I run FXmame, it just dumps core.
<P>A: Make sure you are running FXmame as root. Root privileges
are required to access the 3Dfx hardware
<P>Q: When I run xmame.xfx, it just hangs at the initial game screen.
<P>A: Are you running KDE? For some reason, I can't get keyboard
input under KDE. If you have this problem, switch window managers
or use xmame.svgafx instead.
<H3>Present Limitations/Bugs</H3>

<P>
<UL>
<LI>Antialiasing isn't working quite as well as it should</LI>
<LI>Input problems under KDE</LI>
</UL>
<H3>Future Work</H3>

<P>
<UL>
<LI>Optimize the drawing code to update only the changed portions
of the game bitmap.</LI>
</UL>
<H3>License</H3>

<P>The FXmame code is Copyright 1998 by Mike Oliphant. It may be
used and distributed under the terms of the MAME license.
<H3>Version History</H3>

<P>v0.5 -- December 11th, 1998 ---------------------------
<P>
<UL>
<LI>implemented long copies in screen update</LI>
<LI>added dirty handling. this greatly increases the speed of games
that support the dirty update strategy (although most of them are
older games that already ran at full speed on modern hardware)</LI>
<LI>merged source with xmame b8.1</LI>
</UL>
<P>v0.4 -- October 30th, 1998 --------------------------
<P>
<UL>
<LI>improved alpha handling in vector games - now bitmapped overlays
do not dim the screen o added svgalib support (xmame.svgafx) o fixed
a tiling bug that gave artifacts on texture tile boundaries</LI>
</UL>
<P>v0.3 -- October 29th, 1998 --------------------------
<P>
<UL>
<LI>got rid of extra lines in vector games o added bitmap overlay
in vector games to show options/fps o added antialiasing in vector
games</LI>
</UL>
<P>v0.2 -- October 28th, 1998 --------------------------
<P>
<UL>
<LI>added screenshots o added 3Dfx gamma adjustment o added direct
acceleration of vector games (still buggy)</LI>
</UL>
<P>v0.1 -- October 27th, 1998 --------------------------
<P>
<UL>
<LI>first public release</LI>
</UL>
<H3>Author</H3>

<P>Mike Oliphant <CODE>
<A HREF="mailto:oliphant@ling.ed.ac.uk">(oliphant@ling.ed.ac.uk)</A></CODE> 
<A HREF="http://glmame.linuxgames.com">http://glmame.linuxgames.com</A><P>
<H2><A NAME="ss4.2">4.2 GLmame, an OpenGL driver for xmame</A>
</H2>

<P>The latest version of this driver can be obtained at: 
<A HREF="http://www.jausoft.com/glmame.html">http://www.jausoft.com/glmame.html</A><P>
<H3>Requirements</H3>

<P>To run GLmame you must have:
<P>
<UL>
<LI>An OpenGL implementation</LI>
<LI>libjpeg</LI>
<LI>hardware 3D acceleration (if you want any kind of framerate)</LI>
<LI>the xmame distribution</LI>
</UL>
<H3>Compiling and Installing</H3>

<P>Follow the general instructions for installing xmame. To specify
the OpenGL driver, do the following in the Makefile:
<P>
<UL>
<LI>Select &quot;xgl&quot; as your display method.</LI>
<LI>For runtime printed debug info, add "
-DGLDEBUG"
to the "
GLCFLAGS&quot;
variable.</LI>
<LI>GLU version 1.2 is recommended (e.g., from SGI). If you use Mesa's
GLU, you may have to add "
-DGLU_VERSION_1_2"
to the "
GLCFLAGS"
.</LI>
</UL>
<P>The GLmame executable is called &quot;xmame.xgl&quot;.
<H3>Running</H3>

<P>xmame.xgl runs with the same parameters and uses the same keyboard
commands that xmame.x11 does.
<P>The program starts up in cabinet mode. While this is pretty,
and cool, you'll probably want to actually play in fullscreen mode.
<P>A few extra keyboard commands have been added in the OpenGL driver:
<P>
<UL>
<LI>RIGHT_ALT-A -- toggle antialias filtering (vector)</LI>
<LI>RIGHT_ALT-B -- toggle bilinear filtering (raster)</LI>
<LI>RIGHT_ALT-C -- toggle cabinet/fullscreen display (both)</LI>
<LI>RIGHT_ALT-F -- toggle between fullscreen (max window size) and
startup window size (both)</LI>
<LI>RIGHT_ALT-O -- toggle draw-bitmap (both; nonsense for raster
games, speedup for vector games)</LI>
<LI>RIGHT_ALT-T -- toggle phosphor trails (vector)</LI>
<LI>RIGHT_ALT-PLUS_PAD -- incr. beam size (vector)</LI>
<LI>RIGHT_ALT-MINUS_PAD -- decr. beam size (vector)</LI>
</UL>
<P>The OpenGL driver also adds several command-line options:
<P>
<PRE>
    -[no]fullscreen         Start in fullscreen mode
                            (default: disabled)

    -[no]gldblbuffer        Disable/enable double buffering
                            (default: enabled)

    -gltexture_size &lt;int&gt;   Force the max width and height of one 
                            texture segment (default: autosize)

    -[no]glforceblitmode /  Force blitter for true color modes 15/32bpp
    -[no]glblit             (default: enabled)

    -[no]glext78 /          Force the usage of GL extension number 78,
    -[no]glext              if available (palletted texture)
                            (default: enabled)

    -[no]glbilinear /       Disable/enable bilinear filtering
    -[no]glbilin            (default: enabled)

    -[no]gldrawbitmap /     Disable/enable drawing the bitmap; e.g., 
    -[no]glbitmap           disable within vector games for a speedup
                            (default: enabled)

    -[no]glcolormod         Disable/enable color modulation (intensity,
    -[no]glcmod             gamma)
                            (default: enabled)

    -glbeam &lt;float&gt;         Set the beam size for vector games
                            (default: 1.0)

    -[no]glalphablending /  Disable/enable alpha blending if available
    -[no]glalpha            (default: enabled)

    -[no]glantialias /      Disable/enable antialiasing
    -[no]glaa               (default: enabled)

    -gllibname /            Choose the dynamically loaded OpenGL
    -gllib &lt;string&gt;         library
                            (default: libGL.so)

    -glulibname /           Choose the dynamically loaded GLU library
    -glulib &lt;string&gt;        (default: libGLU.so)

    -[no]cabview            Don't start/start in cabinet view mode
                            (default: don't start in this mode)

    -cabinet &lt;cabname&gt;      Specify which cabinet model to use
                            (default: glmamejau)
</PRE>
<P>Three cabinet models are provided. The default, &quot;glmamejau&quot;,
is designed to look like a standard arcade cabinet, like &quot;glmame&quot;.
The last one, &quot;trans&quot;, is a box with a transparent game
screen.
<P>Note that in order to display the game options or the fps display
in vector games, the game's bitmap is overlaid above the vector display.
Drawing the bitmap is a big cpu hog for some low-end hardware accelerated
OpenGL implementations, so you'll notice that the game slows down
when the bitmap is overlaid.
<P>Because bitmap overlaying is the default, you can toggle it on
and off by pressing the &quot;RIGHT_ALT-O&quot; key, or turn it off
at startup by using the command line option &quot;-noglbitmap&quot;.
<P>A problem with vector games and the cabinet mode is that some
vector points do not reside within the screen coordinates, so you
may see some vectors outside of the cabinet's mame display.
<P><B>*** IMPORTANT! ***</B>
<P>If you have trouble with GLmame, or it is slow, read the &quot;Common
Questions&quot; section. Most of the questions people email me are
answered here.
<H3>Cabinet Models</H3>

<P>Cabinet model information is stored in the &quot;cab&quot; subdirectory
of the directory you specified with the ROMPATH variable in the Makefile.
Path information specified in xmamerc or with the 'rompath' shell
environment variable is currently not used. Each cabinet model has
it's own subdirectory. GLmame will first try to load either the user-specified
cabinet model (using the -cabinet command-line option), or a model
corresponding to the current game name. Failing that, it will use
the generic &quot;glmame&quot; model.
<P>A cabinet model directory must contain a geometry file &lt;modelname&gt;.cab,
and any .jpg files used for textures on the model. The format of
the .cab file will be familiar if you have ever programmed using
OpenGL -- it looks much like an OpenGL display list. The format is
as follows:
<P>
<PRE>
    cabv1.1
</PRE>
<P>This header must be the first 7 characters of the file.
<P>
<PRE>
    #&lt;text&gt;
</PRE>
<P>Comment lines begin with '#'
<P>
<PRE>
    begin &lt;type&gt;
</PRE>
<P>Begins a geometry object, where type is one of (points, polygon,
quads, quad_strip, screen). Each &quot;begin&quot; must be paired
with an &quot;end&quot; statement. A &quot;polygon&quot; is specified
using one vertex per, well... vertex. &quot;quads&quot; are four-sided
polygons, each specified by four vertices in order around the polygon.
A &quot;quad_strip&quot; is a series of four-sided polygons, each
of which shares an edge with the polygons before and after it in
the strip. A &quot;screen&quot; is a quad that defines the actual
area in 3D space where the game will be displayed. only one of these
should be defined. For more info, look at any description of OpenGL
geometry.
<P>
<PRE>
    end
</PRE>
<P>Ends the geometry object begun with &quot;begin&quot;.
<P>
<PRE>
    pointsize &lt;s&gt;
</PRE>
<P>Changes the current pointsize to the corresponding size value
(specified as a floating point number between 0.0 and, e.g., 20.0).
Note: You cannot use this statement between begin and end!
<P>
<PRE>
    color4 &lt;r&gt; &lt;g&gt; &lt;b&gt;
</PRE>
<P>Changes the current color to the corresponding rgb value (specified
as floating point numbers between 0 and 1).
<P>
<PRE>
    color4 &lt;r&gt; &lt;g&gt; &lt;b&gt; &lt;a&gt;
</PRE>
<P>Changes the current color to the corresponding rgba value (specified
as floating point numbers between 0 and 1).
<P>
<PRE>
    shading &lt;type&gt;
</PRE>
<P>Sets the shading type. available types are &quot;smooth&quot;
(which blends colors from one vertex to the next) or &quot;flat&quot;
(which doesn't).
<P>
<PRE>
    vertex &lt;x&gt; &lt;y&gt; &lt;z&gt;
</PRE>
<P>Specifies a vertex for the current geometry object as a point
in 3-space.
<P>
<PRE>
    numtex &lt;num&gt;
</PRE>
<P>Specifies the number of different textures to be loaded. This
declaration must precede any &quot;loadtex&quot; call.
<P>
<PRE>
    loadtex &lt;num&gt; &lt;width&gt; &lt;height&gt; &lt;filename&gt;
</PRE>
<P>Loads texture number &lt;num&gt; from .jpg file &lt;filename&gt;.
The .jpg file *must* be &lt;width&gt; by &lt;height&gt; pixels, and
both &lt;width&gt; and &lt;height&gt; must be powers of two (and
must conform to the hardware requirements of any 3D card you want
the cabinet to work with -- 256x256 for 3Dfx).
<P>
<PRE>
    texcoord &lt;xcoord&gt; &lt;ycoord&gt;
</PRE>
<P>Sets the texture coordinate of the next vertex. This specifies
where in 2D texture space the vertex lies.
<P>
<PRE>
    enable texture
</PRE>
<P>Enables texture mapping (using the currently-selected texture).
<P>
<PRE>
    disable texture
</PRE>
<P>Turns off texture mapping.
<P>
<PRE>
    settex &lt;num&gt;
</PRE>
<P>Select texture &lt;num&gt; for doing texturing. The texture must
previously have been loaded using &quot;loadtex&quot;.
<P>
<PRE>
    camerapan &lt;num&gt;
</PRE>
<P>Starts the camera pan definition that will be followed by &lt;num&gt;
camera transistions. After the last transision definition, the pan
sequence must be ended with an &quot;end&quot; statement.
<P>
<PRE>
    goto &lt;lx&gt; &lt;ly&gt; &lt;lz&gt; &lt;px&gt; &lt;py&gt; &lt;pz&gt; &lt;nx&gt; &lt;ny&gt; &lt;nz&gt;
</PRE>
<P>Relocates and reorients the camera. The arguments are the same
as are used by the OpenGL command &quot;gluLookAt()&quot;. The camera
is positioned at point &lt;lx,ly,lz&gt;, pointing along vector &lt;px,py,pz&gt;,
with &quot;up&quot; normal (the direction that is &quot;up&quot;
for the camera) &lt;nx,ny,nz&gt;.
<P>
<PRE>
    moveto &lt;lx&gt; &lt;ly&gt; &lt;lz&gt; &lt;px&gt; &lt;py&gt; &lt;pz&gt; &lt;nx&gt; &lt;ny&gt; &lt;nz&gt; &lt;frames&gt;
</PRE>
<P>Moves the camera to a new location (specified as in &quot;goto&quot;).
The transition occurs over &lt;frames&gt; frames.
<P>All commands must be on separate lines. Use the (somewhat) commented
glmamejau cabinet as an example to work from.
<H3>Common Questions (FAQ)</H3>

<P>Q: I am only getting a few frames-per-second. This sucks! What
gives? 
<P>A1: You're probably running Mesa in software mode. You should
read the &quot;README.3Dfx&quot; file in the Mesa distro. Specifically,
you need to &quot;setenv MESA_GLX_FX fullscreen&quot;.
<P>A2: You don't have a 3D graphics card. Go buy one (see below)!
<P>Q: When I run xmame.xgl, it just dumps core. That's not as much
fun as 3D Pacman, now is it?
<P>A1: If you are using a 3Dfx card, make sure you are running xmame.xgl
as root. Root privileges are required to access the 3Dfx hardware.
<P>A2: If you're using Mesa and haven't upgraded to v3.0, do so.
<P>
<P>Q: When I run xmame.xgl, it just hangs at the initial game screen.
<P>A: Are you running KDE? For some reason, I can't get keyboard
input under KDE. If you have this problem, switch window managers.
<P>Q: Which graphics cards are usable with xmame.xgl? 
<P>A: We have the following experiences (date 20010327):
<P>
<UL>
<LI>Vodoo3 + DRI OpenGL driver (XFree86 4.0.2), with command line
options &quot;-noglaa&quot; and 16bpp X11 server color depth.</LI>
<LI>GeForce + NVIDIA OpenGL driver + XFree86 4.0.2 with default command
line options and 16/24bpp X11 server color depth.</LI>
<LI>NVIDIA TNT2 + NVIDIA OpenGL driver + XFree86 4.0.2 with command
line options &quot;-bpp 16&quot; and 16bpp (may be 24bpp also ???)
X11 server color depth (OpenGL colortable mapping is buggy).</LI>
<LI>NVIDIA TNT + NVIDIA OpenGL driver + XFree86 4.0.2 with command
line options &quot;-bpp 16&quot; and 16bpp (may be 24bpp also ???)
X11 server color depth (OpenGL colortable mapping is buggy).</LI>
<LI>Matrox MGA 400 + DRI OpenGL driver (XFree86 4.0.2) with command
line options &quot;-bpp 16&quot;, &quot;-noglaa&quot; (???) and 16bpp
(may be 24bpp also ???) X11 server color depth (OpenGL colortable
mapping is buggy).</LI>
</UL>
<P>All of the above drivers work with the option &quot;-bpp 16&quot;
and/or &quot;-noglext78&quot;, the latter of which is very slow,
of course! So it looks like an OpenGL implementation bug is causing
these driver/hardware combinations to only work with these command
line options. The bug may lie within these OpenGL functions:
<P>
<UL>
<LI>glColorTableEXT </LI>
<LI>glColorSubTableEXT</LI>
</UL>
<P>Currently fast and funny driver/hardware combinations are:
<P>
<UL>
<LI>NVIDIA GeForce + NVIDIA OpenGL driver + XFree86 4.0.2; I have
tested the GeForce256 (AGP) hardware. </LI>
<LI>Vodoo + DRI OpenGL driver (XFree86 4.0.2); I have tested the
Vodoo3 hardware.</LI>
</UL>
<P>Q: When I run xmame.xgl, everything is messed up.
<P>A: Read the above experiences ... and try
<P>
<UL>
<LI>switching your X server's bpp value, e.g. switch from 32bpp or
24bpp to 16bpp; </LI>
<LI>the command line option &quot;-bpp 16&quot;;</LI>
<LI>the command line option &quot;-noglaa&quot;;</LI>
<LI>the command line option &quot;-noglext&quot;.</LI>
</UL>
<H3>Present Limitations/Bugs</H3>

<P>
<UL>
<LI>No clipping of vector games (most noticeable in cabinet mode).</LI>
<LI>No preservation of game aspect ratio in cabinet mode.</LI>
</UL>
<H3>Future Work</H3>

<P>
<UL>
<LI>Fixing existing bugs .. are there any ? Or are there some unknown
features only ;-) ? </LI>
<LI>Optimize the drawing code to update only the changed portions
of the game bitmap. Optimizing the dirty code ..</LI>
</UL>
<H3>License</H3>

<P>The GLmame code is based upon Mike Oliphant's GLmame code version
0.6. 
<P>The GLMame code is Copyright 1998 by Mike Oliphant. It may be
used and distributed under the terms of the MAME license. 
<P>Since GLmame version 0.7, the code has been changed and improved
heavily by Sven Goethel --- no license change, of course!
<H3>Version History</H3>

<P>v0.83 -- March 29th, 2001 ---------------------------
<P>
<UL>
<LI>Changed the code heavily to improve compatibility and speed.
The new code is a re-merge of the GLMame32 code, which is a branch
of Mike Oliphant's GLmame code version 0.6. </LI>
<LI>For a detailed list, please consult the file changes.opengl within
the distribution's documentation directory! You can also view the
current changes.opengl here: 
<A HREF="http://www.jausoft.com/glmame.html">http://www.jausoft.com/glmame.html</A>
</LI>
</UL>
<P>v0.6 -- December 14th, 1998 ---------------------------
<P>
<UL>
<LI>added support for systems that do not support paletted textures
(SGI and solaris OpenGL implementations, for example)</LI>
<LI>merged source with xmame b8.1</LI>
</UL>
<P>v0.5 -- October 30th, 1998 --------------------------
<P>
<UL>
<LI>fixed a bug with texturing being left on in bad places</LI>
<LI>added 3Dfx gamma adjustment</LI>
</UL>
<P>v0.4 -- October 21st, 1998 --------------------------
<P>
<UL>
<LI>updated to work with xmame v0.34b5.2</LI>
</UL>
<P>v0.3 -- October 12th, 1998 --------------------------
<P>
<UL>
<LI>fixed verticle screen centering in fullscreen mode</LI>
<LI>moved cabinet and camera panning information into a user-editable
configuration file</LI>
<LI>added 'trans' cabinet model o added double buffer, view type,
and cabinet selection command-line options</LI>
</UL>
<P>v0.2 -- October 6th, 1998 -------------------------
<P>
<UL>
<LI>adding missing 'cab' directory</LI>
</UL>
<P>v0.1 -- October 5th, 1998 -------------------------
<P>
<UL>
<LI>first public release</LI>
</UL>
<H3>Authors</H3>

<P>Since GLmame version 0.7: Sven Goethel 
<A HREF="mailto:sgoethel@jausoft.com">(sgoethel@jausoft.com)</A>
<A HREF="http://www.jausoft.com/glmame.html">http://www.jausoft.com/glmame.html</A><P>
<P>Till GLmame version 0.6: Mike Oliphant <CODE>
<A HREF="mailto:oliphant@ling.ed.ac.uk">(oliphant@ling.ed.ac.uk)</A></CODE> 
<A HREF="http://glmame.linuxgames.com">http://glmame.linuxgames.com</A><P>
<HR>
<A HREF="xmame-doc-5.html">Next</A>
<A HREF="xmame-doc-3.html">Previous</A>
<A HREF="xmame-doc.html#toc4">Contents</A>
</BODY>
</HTML>
